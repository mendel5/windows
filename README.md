# windows-setup
How to set up Windows 10 and Windows 11.

Useful information, tips & tricks and other relevant resources to properly configure a Windows 10 user account/ computer.

Note: Some content is focused on Germany.

## Windows version
- Winver: Check the installed Windows version (`winver.exe`)
  - https://learn.microsoft.com/en-us/windows/release-health/release-information
  - https://en.wikipedia.org/wiki/Windows_10
  - https://learn.microsoft.com/en-us/windows/release-health/windows11-release-information
  - https://en.wikipedia.org/wiki/Windows_11

## Programs
- Mozilla Firefox: https://www.mozilla.org/en-US/firefox/all/
- Google Chrome: https://www.google.com/intl/en-US/chrome/
- Mozilla Thunderbird: https://www.thunderbird.net/en-US/thunderbird/all/
- Adobe Acrobat Reader DC: https://get.adobe.com/reader/otherversions/
- PDF24 Creator: https://tools.pdf24.org/en/creator
- Notepad++: https://notepad-plus-plus.org/downloads/
- Microsoft Office: https://www.office.com/
- LibreOffice: https://www.libreoffice.org/download/download/
- VLC Media Player: https://www.videolan.org/vlc/#download
- iMazing HEIC Converter: https://imazing.com/heic/download

## System tools
- Sysinternals Process Explorer: https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer
- Sysinternals Autoruns: https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns
- Greenshot: https://getgreenshot.org/downloads/ and https://github.com/greenshot/greenshot
- 7-Zip: https://www.7-zip.org/download.html
- WizTree Disk Space Analyzer Portable: https://www.diskanalyzer.com/ (a better alternative to WinDirStat)
  - formerly: WinDirStat Portable: https://portableapps.com/de/apps/utilities/windirstat_portable
- WizFile Portable: https://antibody-software.com/wizfile/ Search, file finder
- Voidtools Everything: https://www.voidtools.com/ Search, file finder

## Video telephony
- Microsoft Teams: https://www.microsoft.com/en-us/microsoft-teams/download-app
- Zoom: https://zoom.us/download
- Cisco Webex Meetings: https://www.webex.com/downloads.html
- Teamviewer: https://www.teamviewer.com/download/windows
- Teamviewer German: https://www.teamviewer.com/de/download/windows
- Linphone: https://www.linphone.org/technical-corner/linphone

## Remove Adware and Potentially Unwanted Programs
- Malware, Virus, Viren, Antiviren, Antivirus, Adware, PUPs
- AdwCleaner: https://www.malwarebytes.com/adwcleaner
- Malwarebytes:
  - https://www.malwarebytes.com/mwb-download
  - https://de.malwarebytes.com/mwb-download/

## Analysis
### Internal tools
- Task Manager --> Autostart --> Show `command line`
- Device Manager (`devmgmt.msc`)
- Disk Management (`diskmgmt.msc`)
- Settings --> Devices --> Printers & scanners --> `Print server properties`
- Check if `TPM` and `Secure Boot` are enabled/active, for example by using `WhyNotWin11`, `msinfo32`, `hwinfo`
  - https://learn.microsoft.com/en-us/mem/intune/user-help/you-need-to-enable-secure-boot-windows
  - https://learn.microsoft.com/de-de/mem/intune/user-help/you-need-to-enable-secure-boot-windows
- Bitlocker (see section below)

### Internal tool: Bitlocker
- Always check the status of Bitlocker for all hard drives
- If Bitlocker is enabled/active, make a backup of all Bitlocker recovery keys and save them somewhere other than the hard drive that is encrypted with Bitlocker (!)
- How to check Bitlocker status:
  - Disk management (`diskmgmt.msc`)
  - Bitlocker settings (Start menu search for `Bitlocker`)
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/manage-bde
- https://superuser.com/questions/1299600/is-a-volume-with-bitlocker-waiting-for-activation-encrypted-or-not (there are multiple stages of Bitlocker encryption)
- https://www.manageengine.com/products/os-deployer/help/how-to-disable-bitlocker-encryption.html

```
manage-bde -status

manage-bde -off C:
```

### External tools
- Nirsoft DevManView: https://www.nirsoft.net/utils/device_manager_view.html
- Ghostbusters: https://www.majorgeeks.com/files/details/ghostbuster.html
- DriverStoreExplorer (RAPR): https://github.com/lostindark/DriverStoreExplorer
- Sysinternals AutoRuns: https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
- Sysinternals ProcessExplorer: https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer
- WhyNotWin11: https://github.com/rcmaehl/WhyNotWin11
- Wizfile (Windows Search alternative): https://antibody-software.com/wizfile/download
  - or Everything: https://www.voidtools.com/
- Wiztree (WinDirStat alternative): https://www.diskanalyzer.com/download
- CrystalDiskInfo Portable: https://www.computerbase.de/downloads/systemtools/festplatten/crystaldiskinfo/
- HWinfo Portable: https://www.computerbase.de/downloads/systemtools/hwinfo/

## Other 1
- O&O ShutUp10 https://www.oo-software.com/en/shutup10
- Windows 10 Decrapifier https://community.spiceworks.com/scripts/show/4378-windows-10-decrapifier-18xx-19xx-2xxx
- YES _ Windows 10: Cortana deinstallieren https://www.netzwelt.de/anleitung/180485-windows-10-cortana-deinstallierenso-gehts.html
- Cortana vollständig deinstallieren https://praxistipps.chip.de/cortana-vollstaendig-deinstallieren-so-gehts_44689
- Windows 10 OneDrive entfernen https://www.netzwelt.de/tutorial/163642-windows-10-so-deinstalliert-onedrive.html
- OneDrive deinstallieren https://www.heise.de/tipps-tricks/OneDrive-deinstallieren-so-geht-s-4975944.html
- YES _ Web-Suche in Windows 10 deaktivieren (mit Gruppenrichtlinien) https://www.windowspro.de/wolfgang-sommergut/web-suche-windows-10-deaktivieren-gruppenrichtlinien
- Windows 10 - Websuche im Startmenü deaktivieren https://www.bennetrichter.de/anleitungen/windows-10-websuche-deaktivieren/
- How to Force Uninstall Programs on Windows 10/11 Computers https://wccftech.com/how-to/how-to-force-uninstall-programs-on-windows-10-11-computers/
- Windows 10 installieren 2022 - Mit USB + Einrichten & Treiber Installation, HardwareDealz https://www.youtube.com/watch?v=G5TGARdHkRM 
- Systemfehler mit SFC und DISM reparieren (`sfc /scannow`) https://www.netzwelt.de/anleitung/166183-windows-10-so-behebt-fehler-ueber-sfc-dism.html
- https://www.makeuseof.com/difference-between-chkdsk-sfc-and-dism-in-windows-10/
- https://superuser.com/questions/1658332/run-sfc-scannow-or-chkdsk-f-first
- https://superuser.com/questions/1579030/what-is-the-purpose-of-the-dism-restorehealth-parameter-and-sfc
- https://superuser.com/questions/1330365/how-will-dism-online-cleanup-image-restorehealth-affect-my-current-configurat
- Deactivate Internet Explorer https://docs.microsoft.com/en-us/troubleshoot/developer/browsers/installation/disable-internet-explorer-windows

## Other 2
- Windows Update Driver Store Explorer (RAPR): https://github.com/lostindark/DriverStoreExplorer
- Snappy Driver Installer Origin: https://www.snappy-driver-installer.org/ (use with caution)
- Patch My PC (check for outdated software): https://patchmypc.com/home-updater
- Samsung Magician Software for SSDs: https://semiconductor.samsung.com/consumer-storage/support/tools/
- Micron Crucial Storage Executive: https://www.crucial.com/support/storage-executive
- CrystalDiskInfo: https://crystalmark.info/en/download/
- Portable Apps: https://portableapps.com/
- CPU-Z: https://en.wikipedia.org/wiki/CPU-Z

## Remove or Uninstall Programs
If a programm cannot be uninstalled successfully through the standard procedures, this program might help
- Revo Uninstaller Free: https://www.revouninstaller.com/revo-uninstaller-free-download/

## Network Scanner
- Advanced IP Scanner: https://www.advanced-ip-scanner.com
- Angry IP Scanner: https://angryip.org

## WhyNotWin11
- Achitecture: `64bit` instead of `32bit` (both CPU and OS)
- Boot method: `UEFI` instead of `Legacy`
- Disk partition type: `GPT` instead of `MBR`

Source:
- https://github.com/rcmaehl/WhyNotWin11
- Download WhyNotWin11 latest stable release (64-bit): https://github.com/rcmaehl/WhyNotWin11/releases/latest/download/WhyNotWin11.exe

## Get directly to UEFI-BIOS
How to restart/reboot Windows 10 to get directly to UEFI-BIOS. Warning: Even before you initiate the restart, all open apps will be closed. Save your work before you do this!
- Shift method (recommended): `Start menu` --> select `Power` (Power button icon) --> hold `Shift` on keyboard while selecting `Restart` (this closes all Windows apps) --> select `Troubleshoot` --> `Advanced options` --> `UEFI firmware settings`
- Settings method: `Windows settings` --> `Update & Security` --> `Recovery` --> `Advanced startup` --> `Restart now` --> `Troubleshoot` --> `Advanced options` --> `UEFI firmware settings`

Source:
- https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/boot-to-uefi-mode-or-legacy-bios-mode?view=windows-10
- https://www.pc-magazin.de/ratgeber/bios-uefi-starten-windows-10-3201227.html

## Microsoft account
- https://account.microsoft.com Microsoft account overview
- https://account.microsoft.com/devices Devices linked to Microsoft account
- https://account.microsoft.com/services/microsoft365/install Devices logged in to Microsoft 365
- https://account.microsoft.com/devices/content Devices linked to the Microsoft Store

## Remove/Uninstall Cortana
- Right click on the Windows icon in the bottom left
- Click on `Windows PowerShell (Administrator)`
- Copy the following command:

```
Get-AppxPackage -allusers Microsoft.549981C3F5F10 | Remove-AppxPackage
```

- Paste it in the Windows PowerShell by pressing `Right click`
- Press Enter

If the command above does not work, try one of these commands:
```
Get-AppxPackage *Microsoft.549981C3F5F10* -AllUsers | Remove-AppxPackage -AllUsers

Get-AppxPackage *Microsoft.549981C3F5F10* -AllUsers | Remove-AppxPackage
```

## Remove/Uninstall Xbox
Similar to the description above.
```
Get-AppxPackage *Xbox* | Remove-AppxPackage
```

Sources:
- https://www.heise.de/forum/heise-online/Kommentare/Windows-Microsofts-Sound-Management-ist-eine-Qual/Re-Die-ins-Betriebssystem-integrierte-Xbox-Game-Bar/posting-42299195/show/
- https://www.lifewire.com/remove-xbox-app-from-windows-10-4587103

## Rename a Wired Network Connection
- Press `Win` + `R`
- Enter `regedit.exe` or simply `regedit`
- Open the app as an admin, e.g. by pressing `Ctrl` + `Shift` + `Enter`
- Open this path:
```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles
```
- The profiles are listed in the folders below

Sources:
- https://www.tecchannel.de/a/netzwerknamen-unter-windows-10-aendern,3277868
- https://www.pctipp.ch/praxis/windows/windows-10-netzwerke-umbenennen-so-gehts-2002978.html

## Change hostname
- Press the `Windows` key in the bottom left
- Search for `PC Info`
- Click on `Rename this PC`

Sources:
- https://support.microsoft.com/en-us/windows/rename-your-windows-10-pc-750bc75d-8ff8-e99a-b9dc-04dff566ae74

## Show icons on desktop
Gemeinsame Symbole auf dem Desktop, Desktopsymboleinstellungen
- Einstellungen --> Personalisierung --> Designs --> Desktopsymboleinstellungen
- Settings --> Personalization --> Themes --> Desktop icon settings

## Password of SMB fileshares
- Press `Win` + `R`
- Enter `netplwiz.exe`

## Remove Web Results from Windows Search
- Suche: `Gruppenrichtlinien bearbeiten` / `gpedit.msc`
- `Administrative Vorlagen`
- `Windows-Komponenten`
- `Suche`
- `Nicht im Web suchen und keine Webergebnisse in der Suche anzeigen`

## Disable Bing in the Start Menu Search
- https://www.howtogeek.com/224159/how-to-disable-bing-in-the-windows-10-start-menu/

## Disable OneDrive Synchronization
- https://www.cbackup.com/articles/stop-onedrive-from-syncing-6688.html
- https://www.minitool.com/backup-tips/how-to-disable-onedrive.html
- https://helpdeskgeek.com/windows-10/how-to-disable-onedrive-on-your-windows-10-pc-why-youd-want-to/

## Useful Windows applications and commands
Helpful shortcut:
- `Win` + `R`: Run / Ausführen

The following applications are located in the folder `C:\WINDOWS\system32\`:
- `winver.exe` About Windows / Info über Windows --> Windows-Version
  - About Windows: Display Windows version information.
  - Info: Windows-Versionsinformationen anzeigen.
- `msinfo32.exe` System Information / Systeminformationen
  - System Information: View advanced information about hardware and software settings.
  - Systeminformation: Erweiterte Informationen zu Hardware- und Softwareeinstellungen anzeigen.
- `devmgmt.msc` Device Manager / Geräte-Manager
- `diskmgmt.msc` Disk Management / Datenträgerverwaltung
- `dfrgui.exe` Optimize Drives (Defragment and Optimize Drives) / Laufwerke optimieren (Laufwerke defragmentieren und optimieren)
- `taskmgr.exe` Task Manager / Task-Manager (Shortcut: `Ctrl`+`Shift`+`Esc`)
  - Task Manager: View details about programs and processes running on your computer.
  - Task-Manager: Details zu Programmen und Prozessen anzeigen, die auf dem Computer ausgeführt werden.
- `resmon.exe` Resource Monitor / Ressourcenmonitor
  - Resource Monitor: Monitor the performance and resource usage of the local computer.
  - Ressourcenmonitor: Überwacht die Leistung und Ressourcennutzung des lokalen Computers.
- `perfmon.msc` Performance Monitor / Leistungsüberwachung (auch `perfmon.exe`)
  - Performance Monitor: Monitor the performance of local or remote computers.
  - Leistungsüberwachung: Überwacht die Leistung von lokalen Computern oder Remotecomputern.
- `regedit.exe` Registry Editor / Registrierungs-Editor (auch `regedt32.exe`)
  - Registry Editor: Make changes to the Windows registry.
  - Registrierungs-Editor: Windows-Registrierung ändern.
- `netplwiz.exe` User Accounts (Manage Passwords) / Benutzerkonten (Kennwörter verwalten)
- `compmgmt.msc` Computer Management / Computerverwaltung
  - Computer Management: View and configure system settings and components.
  - Computerverwaltung: Zeigt Systemeinstellungen und -komponenten an und konfiguriert sie.
- `cleanmgr.exe` Disk Cleanup / Datenträgerbereinigung
- `msconfig.exe` System Configuration / Systemkonfiguration
- `sysdm.cpl` System Properties (Computer Name) / Systemeigenschaften (Computername)
- `SystemPropertiesProtection.exe` System Properties (System Protection) / Systemeigenschaften (Computerschutz)
- `eventvwr.msc` Event Viewer / Ereignisanzeige (auch `eventvwr.exe`)
  - Event Viewer: View monitoring and troubleshooting messages.
  - Ereignisanzeige: Überwachungs- und Problembehandlungsmeldungen anzeigen.
- `UserAccountControlSettings.exe` User Account Control Settings / Einstellungen für Benutzerkontensteuerung
  - Change UAC Settings: Change User Account Control settings.
  - UAC-Einstellungen ändern: Ändert Einstellungen für Benutzerkontensteuerung.
- `wscui.cpl` Security and Maintenance (Control Panel) / Sicherheit und Wartung (Systemsteuerung)
  - Security and Maintenance: Open Security and Maintenance.
  - Sicherheit und Wartung: Öffnet Sicherheit und Wartung.
- `appwiz.cpl` Programs and Features (Control Panel, list of installed programs) / Programme und Features (Systemsteuerung, Liste der installierten Programme)
  - Programs: Launch, add or remove programs and Windows components.
  - Programme: Programme und Windows-Komponenten starten, hinzufügen oder entfernen.
- `inetcpl.cpl` Internet Properties (maybe related to Internet Explorer?) / Eigenschaften von Internet (eventuell für Internet Explorer?)
  - Internet Options: View Internet Properties.
  - Internetoption: Interneteigenschaften anzeigen.
- `cmd.exe` Command Prompt / Eingabeaufforderung
  - Command Prompt: Open a command prompt window.
  - Eingabeaufforderung: Eingabeaufforderungsfenster öffnen.
- `rstrui.exe` System Restore / Systemwiederherstellung
  - System Restore: Restore your computer system to an earlier state.
  - Systemwiederherstellung: Früheren Zustand des Computers wiederherstellen.
- `services.msc` Services / Dienste
- `taskschd.msc` Task Scheduler / Aufgabenplanung
- `printmanagement.msc` Print Management / Druckverwaltung
- `mdsched.exe` Windows Memory Diagnostic / Windows-Speicherdiagnose
- `control.exe /name Microsoft.Troubleshooting`
  - Windows Troubleshooting: Troubleshoot problems with your computer.
  - Windows-Problembehandlung: Behandelt Probleme mit dem Computer.
- `cmd.exe /k %windir%\system32\ipconfig.exe`
  - Internet Protocol Configuration: View and configure network address settings.
  - Internetprotokollkonfiguration: Netzwerkadresseinstellungen anzeigen und konfigurieren.
- `msra.exe`
  - Remote Assistance: Receive help from (or offer help to) a friend over the Internet.
  - Remoteunterstützung: Über das Internet Hilfe von einem Freund erhalten (oder einem Freund Hilfe anbieten).
- `quickassist.exe` Quick Assist / Remotehilfe (Windows 10), Schnellhilfe (Windows 11), `Ctrl` + `Win` + `Q`
- `control.exe` Control Panel / Systemsteuerung, Classical settings (Windows 7)
- `control.exe folders` File Explorer Options (Folder options) / Ordneroptionen
- `control.exe system` About (Settings --> System --> About) / Info (Einstellungen --> System --> Info), Device specifications, Rename this PC, Windows specifications
  - System Properties: View basic information about your computer system settings.
  - Systemeigenschaften: Grundlegende Informationen zu den Systemeinstellungen des Computers anzeigen.

These applications are almost always included in Windows. Most of these programs are part of the "Windows Administrative Tools". Die meisten dieser Programme sind Teil der "Windows-Verwaltungsprogramme".
- `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Administrative Tools`

The following applications have other locations:
- `This PC`, formerly `My Computer` / `Dieser PC`, ehemals `Arbeitsplatz` (`Win`+`E`)
- `Quick access` / `Schnellzugriff` (`Win`+`E`)
- `PCHealthCheck.exe` PC Health Check / PC-Integritätsprüfung
  - located at `C:\Program Files\PCHealthCheck\PCHealthCheck.exe`
- `SystemSettings.exe` Settings / Einstellungen, ImmersiveControlPanel, Modern settings (Windows 10)
  - located at `C:\Windows\ImmersiveControlPanel\SystemSettings.exe`

## Useful shortcuts
- Keyboard shortcuts in Windows https://support.microsoft.com/en-us/windows/keyboard-shortcuts-in-windows-dcc61a57-8ff0-cffe-9796-cb9706c75eec
- `Ctrl` + `Shift` + `Win` + `B`: Wake PC from blank or black screen (commonly understood to "restart the graphics driver")
  - https://superuser.com/questions/1127463/what-does-ctrlwinshiftb-do-in-windows

## Nasty Networking Issue
Problem:
- Windows 10 error code 0x80070035
- When trying to open a network share, Windows 10 does not show a prompt to enter the username and password

Solution:
- Enter the NAS hostname, username and password manually via `netplwiz`

Question:
- Why does Windows 10 not show the prompt to enter the username and password for a network share? Maybe it is related to the user permissions or rights?

Links:
- https://social.technet.microsoft.com/Forums/windows/de-DE/17c9ea7d-52df-4ef9-95fa-0a961d11bfa3/fix-for-cannot-access-nas-drives-sharefolder-is-not-accessible-or-quoterror-code
- https://www.stellarinfo.co.in/blog/how-to-fix-nas-device-not-visible-on-windows-10/
- https://kb.synology.com/en-nz/DSM/tutorial/What_can_I_do_if_my_Synology_NAS_does_not_show_up_in_Network_in_Windows_File_Explorer
- https://www.buffalotech.com/knowledge-base/windows-10-cannot-access-shares-on-nas
- https://www.google.de/search?q=%220x80070035%22
- https://basic-tutorials.de/ratgeber/software/fehlerbehebung-0x80070035-fehlercode-der-netzwerkpfad-wurde-nicht-gefunden/
- https://de.minitool.com/nachrichten/der-netzwerkpfad-wurde-nicht-gefunden.html
- https://hdwh.de/windows-10-netzwerk-zeigt-fehler-0x80070035-der-netzwerkpfad-wurde-nicht-gefunden/
- https://www.borncity.com/blog/2015/09/21/windows-10-netzwerk-zeigt-fehler-0x80070035/
- https://www.expertiger.de/windows-problem/windows-fehler-0x80070035
- https://www.windows-faq.de/2018/02/22/0x80070035-fehlercode-der-netzwerkpfad-wurde-nicht-gefunden/
- https://www.youtube.com/watch?v=5bIcJluf-0Q Network Path Not Found - WIndows 10 1803 - Guaranteed Fix
- https://docs.microsoft.com/en-us/troubleshoot/windows-client/networking/cannot-access-shared-folder-file-explorer
- https://docs.microsoft.com/en-us/troubleshoot/windows-client/networking/mapped-drives-not-available-from-elevated-command
- https://docs.qnap.com/operating-system/qts/5.0.x/de-de/webserver-091B47DC.html
- https://forum.qnapclub.de/thread/58177-keine-verbindung-%C3%BCber-browser/

## chkdsk
Open the command line (CMD) as an administrator.
```
chkdsk c: /r /v

c:
Is for the drive with the letter "c".
Specifies the drive letter (followed by a colon), mount point, or volume name.

/r
Locates bad sectors and recovers readable information.
The disk must be locked.
/r includes the functionality of /f, with the additional analysis of physical disk errors.

/v
Displays the name of each file in every directory as the disk is checked.
```

```
How to evaluate the results of chkdsk:

Ereignisanzeige (Event Viewer)

Ereignisanzeige (Lokal) --> Windows-Protokolle --> Anwendung

Look for an entry with the source "Wininit"
```

Sources:
- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/chkdsk
- https://old.reddit.com/r/DataHoarder/comments/oc54a1/which_software_to_use_to_check_drive_health/
- https://www.filehorse.com/download-victoria-ssd-hdd/ Victoria HDD/SSD download
- https://recoverhdd.com/blog/using-victoria-for-testing-repair-hard-drive.html Victoria HDD/SSD How to
- https://hdd.by/victoria_faq/ Victoria FAQ

Linux:
```
sudo badblocks -sv /dev/sda

-s
show progress

-v
be "verbose" and output bad sectors detected to stdout
```
Source:
- https://wiki.archlinux.org/title/badblocks

Linux:
```
sudo e2fsck -fvn /dev/sda2

-f
Force checking even if the file system seems clean

-v
Verbose mode

-n
Open the filesystem read-only, and assume an answer of 'no' to all questions. Allows e2fsck to be used non-interactively.
```
- https://unix.stackexchange.com/questions/347280/how-to-perform-full-check-of-ext4-file-system-structure

## Other important tools
```
DISM / dism

sfc

In-place upgrade
```

Links:
- https://www.tenforums.com/tutorials/16397-repair-install-windows-10-place-upgrade.html How to Do a Repair Install of Windows 10 with an In-place Upgrade

## defrag
Open the command line (CMD) as an administrator.
```
defrag c: /h /u /v /x

c:
Specifies the drive letter or mount point path of the volume to be defragmented or analyzed.

/h
Runs the operation at normal priority (default is low).

/u
Prints the progress of the operation on the screen.

/v
Prints verbose output containing the fragmentation statistics.

/x
Performs free space consolidation on the specified volumes.
```
Sources:
- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/defrag

Linux:
```
sudo e4defrag -c /dev/sda2

sudo e4defrag /dev/sda2

-c
Get a current fragmentation count and an ideal fragmentation count, and calculate fragmentation score based on them.
```
Sources:
- https://askubuntu.com/questions/221079/how-to-defrag-an-ext4-filesystem
- https://man7.org/linux/man-pages/man8/e4defrag.8.html

## Recommended hardware
### Laptop brands
- Lenovo

### Printers
- Epson
- Brother

## Windows Update error: KB5034441 with error code 0x80070643
- KB5034441: https://support.microsoft.com/en-us/topic/kb5034441-windows-recovery-environment-update-for-windows-10-version-21h2-and-22h2-january-9-2024-62c04204-aaa5-4fee-a02a-2fdea17075a8
- Error code 0x80070643
- KB5028997: Instructions to manually resize your partition to install the WinRE update
  - https://support.microsoft.com/en-us/topic/kb5028997-instructions-to-manually-resize-your-partition-to-install-the-winre-update-400faa27-9343-461c-ada9-24c8229763bf
- https://superuser.com/questions/561605/how-can-i-increase-my-shrink-space-in-disk-management
- https://www.downloadsource.net/how-to-fix-the-windows-re-image-was-not-found-winre-wim-install-wim-install-esd/n/20721/#google_vignette
- https://support.microsoft.com/en-us/windows/create-installation-media-for-windows-99a58364-8c02-206f-aa6f-40c3b507420d
- https://www.heise.de/hintergrund/Missgluecktes-Windows-Update-im-Januar-2024-Was-Sie-tun-koennen-9613929.html
- https://www.heise.de/news/Microsoft-Keine-automatische-Loesung-fuer-0x80070643-Update-Fehler-mehr-geplant-9706650.html
- https://www.computerbase.de/2024-01/kb5034441-windows-10-update-bricht-mit-fehlercode-0x80070643-ab/
- https://superuser.com/questions/1210470/multiple-recovery-partitions-in-windows-10
- Important:
  - Always check first if the OS partition is able to shrink (`diskmgmt.msc`)!
  - Always disable `reagentc` before deleting a Windows recovery (WinRE) partition! Otherwise you have to extract the Windows recovery image (`winre.wim`) from the Windows 10 ISO which is very time consuming.
  - After all changes have been made, always check in `This PC` and `diskmgmt.msc` that no drive letter is assigned to the newly created WinRE partition. In other words, the new WinRE partition should not be visible in `This PC`. This is especially important for MBR-formatted drives. If a letter is assigned to the partition, then the letter can be removed through `diskmgmt.msc`.
- Recommended size:
  - Windows 10 EFI partition: `500 MB` - `1000 MB`
  - Windows 10 recovery partition: `1000 MB` - `2000 MB`

```
reagentc /info
reagentc /disable
reagentc /enable

diskpart

delete partition override


list part

list vol


create partition primary id=de94bba4-06d1-4d40-a16a-bfd50179d6ac

gpt attributes =0x8000000000000001

format quick fs=ntfs label="Windows RE tools"
```

## Windows Remotehilfe, Schnellhilfe, Quick Assist
- Shortcut: `Ctrl` + `Win` + `Q` / `Strg` + `Win` + `Q`
- https://support.microsoft.com/de-de/windows/l%C3%B6sen-von-pc-problemen-%C3%BCber-eine-remoteverbindung-b077e31a-16f4-2529-1a47-21f6a9040bf3
- https://support.microsoft.com/en-us/windows/solve-pc-problems-over-a-remote-connection-b077e31a-16f4-2529-1a47-21f6a9040bf3
- https://learn.microsoft.com/de-de/windows/client-management/client-tools/quick-assist
- https://support.microsoft.com/de-de/windows/remotehilfe-installieren-c17479b7-a49d-4d12-938c-dbfb97c88bca

## Phone Link
- Microsoft Phone Link, `PhoneExperienceHost.exe`
- https://answers.microsoft.com/en-us/windows/forum/all/phoneexperiencehostexe/c808fa50-1d58-4465-8248-13840c0fb399
- Press `Windows key` + `X`
- Select `Windows Powershell (Admin)`
- Copy and paste this command:

```
get-appxpackage *Microsoft.YourPhone* | remove-appxpackage
```

## Lenovo Touchpad not working properly
Problem:
- After updating the firmware of a touchpad (trackpad) and trackpoint of a Lenovo laptop with the `ELAN TrackPoint Firmware Update Utility`, the touchpad is not working properly anymore. It is laggy, unresponsive and does not register all inputs. Unfortunately there is no old firmware available that could be used to overwrite the new firmware. Note: This is about firmwre, not about drivers.

Solution:
- Go to the UEFI-BIOS and set the trackpoint to `Disabled` but keep the touchpad `Enabled`. Unfortunately you will not be able to use the trackpoint (the red dot embedded in the keyboard) anymore and also the three mouse buttons above the touchpad will not work anymore. However, the touchpad is working again. This is not a perfect solution, but at least you can use the laptop without having to connect an external mouse.

Update from some time later: Unfortunately, this did not fix the touchpad. It is still not working properly.

## Moving to a new Windows computer
Make sure that the application has the same version on the old and new computer.

### Mozilla Firefox
- Important folder paths can be found here: `about:profiles`
- `C:\Users\my_username\AppData\Roaming\Mozilla\Firefox\Profiles\abc123.default` (Root directory)
- `C:\Users\my_username\AppData\Local\Mozilla\Firefox\Profiles\abc123.default` (Local directory)

### Mozilla Thunderbird
- Important folder paths can be found here: `about:profiles`
  - German: `Menüleiste` --> `Hilfe` --> `Informationen zur Fehlerbehebung` --> `Allgemeine Informationen` (Abschnitt) --> `about:profiles` anklicken (am unteren Ende des Abschnitts)
  - English: `Menu bar` --> `Help` --> `Troubleshooting Information` --> `Application Basics` (section) --> Click on `about:profiles` (at the bottom of the section)
- `C:\Users\my_username\AppData\Roaming\Thunderbird\Profiles\abc123.default-release` (Root directory)
- `C:\Users\my_username\AppData\Local\Thunderbird\Profiles\abc123.default-release` (Local directory)
- https://www.thunderbird-mail.de/lexicon/entry/40-profil-manager-profile-verwalten-erstellen-und-l%C3%B6schen/#4-Neuerung-ab-Thunderbird-52

Note: The Root Directory stores user profile data such as bookmarks, passwords, and preference settings. The Local Directory stores the disk cache and other temporary data.
Source: https://support.mozilla.org/en-US/kb/profile-manager-create-remove-switch-firefox-profiles
